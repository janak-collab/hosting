#!/bin/bash
# GMPM Log Monitor
clear
echo "ðŸ“Š GMPM Portal - Live Monitor"
echo "============================="
echo "Press Ctrl+C to exit"
echo ""

# Function to check endpoint
check_endpoint() {
    local endpoint=$1
    local code=$(curl -s -o /dev/null -w "%{http_code}" "https://gmpm.us$endpoint")
    if [ "$code" = "200" ]; then
        echo -e "âœ“ $endpoint\t[OK]"
    else
        echo -e "âœ— $endpoint\t[ERROR: $code]"
    fi
}

while true; do
    echo -e "\nðŸ”„ Status Check - $(date '+%Y-%m-%d %H:%M:%S')"
    echo "----------------------------------------"
    
    # Check main endpoints
    check_endpoint "/"
    check_endpoint "/status"
    check_endpoint "/health"
    
    # Check for recent errors
    echo -e "\nðŸ“‹ Recent Errors:"
    if [ -f ~/logs/php_errors.log ]; then
        tail -3 ~/logs/php_errors.log | grep -i error || echo "No recent errors"
    else
        echo "Log file not found"
    fi
    
    # Wait 30 seconds before next check
    sleep 30
    clear
done
